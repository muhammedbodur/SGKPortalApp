============================================================================
MYSQL SYNC HATASI Ã‡Ã–ZÃœMÃœ
============================================================================

SORUN:
------
MySQL sync sÄ±rasÄ±nda FK_PER_Personeller_PER_Sendikalar foreign key constraint hatasÄ±.
Legacy MySQL'de sendika deÄŸerleri hardcoded (0-9, 99) ve tablo yok.
SQL Server'da bu SendikaId'ler mevcut deÄŸil.

Ã‡Ã–ZÃœM:
------

1. LegacyAtanma Entity ve Repository Eklendi
   âœ… LegacyAtanma.cs
   âœ… ILegacyAtanmaRepository.cs
   âœ… LegacyAtanmaRepository.cs
   âœ… MysqlDbContext.cs gÃ¼ncellendi

2. LegacyKod AlanÄ± Eklendi (Mapping iÃ§in)
   âœ… AtanmaNedenleri.cs - LegacyKod alanÄ± eklendi
   âœ… Sendika.cs - LegacyKod alanÄ± eklendi
   
   MantÄ±k: MySQL'deki ID deÄŸerleri ile SQL Server'daki ID deÄŸerleri farklÄ± olabilir.
   LegacyKod ile mapping yaparak doÄŸru kayÄ±tlarÄ± eÅŸleÅŸtiriyoruz.

3. SendikaId ve AtanmaNedeniId Validasyonu (LegacyKod ile)
   âœ… MySqlSyncService.CreatePersonelFromLegacyAsync - LegacyKod mapping
   âœ… MySqlSyncService.UpdatePersonelFromLegacyAsync - LegacyKod mapping
   
   MantÄ±k: Legacy MySQL'deki deÄŸerler LegacyKod ile eÅŸleÅŸtiriliyor.

4. Import Script'leri OluÅŸturuldu
   ğŸ“„ IMPORT_SENDIKALAR_FULL.sql - Sendika kayÄ±tlarÄ± (LegacyKod ile)
   ğŸ“„ IMPORT_ATANMA_NEDENLERI.sql - Atanma nedenleri (LegacyKod ile)
   
   PHP Legacy Mapping:
   - 0  = BelirtilmemiÅŸ
   - 1  = BÃ¼ro EmekÃ§ileri SendikasÄ±
   - 2  = BÃ¼ro Memur Sen
   - 3  = TÃ¼rk BÃ¼ro Sen
   - 4  = TÃ¼rkiye Demokratik Ofis Ã‡al. Sen.
   - 5  = BÃ¼ro Hak Sen
   - 6  = BirleÅŸik BÃ¼ro-Ä°ÅŸ
   - 7  = TÃ¼m BÃ¼ro-Sen
   - 8  = Ufuk BÃ¼ro Sen
   - 9  = Savdes-Sen
   - 99 = Ãœye DeÄŸil

ADIMLAR:
--------

1. SQL Server'da migration Ã§alÄ±ÅŸtÄ±r (LegacyKod kolonlarÄ± iÃ§in):
   
   Package Manager Console'da:
   > Add-Migration Add_LegacyKod_To_Sendika_And_AtanmaNedeni
   > Update-Database

2. SQL Server'da import script'lerini Ã§alÄ±ÅŸtÄ±r:
   
   SQL Server Management Studio'da sÄ±rasÄ±yla:
   > IMPORT_ATANMA_NEDENLERI.sql
   > IMPORT_SENDIKALAR_FULL.sql

3. UygulamayÄ± yeniden baÅŸlat ve sync'i test et

NOT:
----
- LegacyKod ile mapping yapÄ±ldÄ±ÄŸÄ± iÃ§in MySQL ve SQL Server ID'leri farklÄ± olabilir
- Ã–rnek: MySQL atanma_id=1 â†’ SQL Server AtanmaNedeniId=5 (LegacyKod=1 ile eÅŸleÅŸir)
- Sendika alanÄ± nullable olduÄŸu iÃ§in, eÅŸleÅŸmeyen deÄŸerler null olarak kaydedilecek
- Sync loglarÄ±nda "LegacyKod X ile eÅŸleÅŸen sendika bulunamadÄ±" uyarÄ±sÄ± gÃ¶rebilirsiniz
- Bu normal bir durumdur ve hata deÄŸildir

LEGACY KOD MAPPING Ã–RNEÄÄ°:
--------------------------
MySQL: kullanici.sendika = 1 (BÃ¼ro EmekÃ§ileri SendikasÄ±)
   â†“ LegacyKod mapping
SQL Server: PER_Sendikalar.SendikaId = 1, LegacyKod = 1
   â†“
Personel.SendikaId = 1 (DoÄŸru eÅŸleÅŸme!)

MySQL: kullanici.atanma = 5 (KPSS Ä°lk Atama)
   â†“ LegacyKod mapping
SQL Server: PER_AtanmaNedenleri.AtanmaNedeniId = 12, LegacyKod = 5
   â†“
Personel.AtanmaNedeniId = 12 (DoÄŸru eÅŸleÅŸme!)
